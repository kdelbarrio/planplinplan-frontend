<section class="favorites">
  <h1>Mis lugares favoritos</h1>
<div class="events__grid">
  <mat-form-field appearance="outline">
    <mat-label><mat-icon>add</mat-icon> Añadir municipio</mat-label>
    <input
      type="text"
      matInput
      [formControl]="form.controls.place"
      [matAutocomplete]="auto"
      placeholder="Escribe para buscar…">
    <button matSuffix mat-icon-button *ngIf="form.controls.place.value" (click)="clearPlace()" aria-label="Limpiar">
      <mat-icon>close</mat-icon>
    </button>

  <mat-autocomplete #auto="matAutocomplete"
                    (optionSelected)="onMunicipalitySelected($event.option.value)">
    <mat-option *ngFor="let m of municipalityOptions()" [value]="m">
      {{ m }}
    </mat-option>

    <mat-option *ngIf="!suggestLoading() && (form.value.place?.length ?? 0) >= 2 && municipalityOptions().length === 0" disabled>
      Sin coincidencias
    </mat-option>
  </mat-autocomplete>

  </mat-form-field>

  <ng-container *ngIf="(places$ | async) as places">
    <p *ngIf="!places.length" >Aún no has guardado lugares.</p>

    <div *ngIf="places.length">
      <mat-card *ngFor="let l of places" class="event-card mat-elevation-z1" appearance="outlined">
         <div>
           <mat-icon>place</mat-icon>
         </div>
        <div class="event-card__body">

          <h2>{{ l.municipality }}</h2>
          
          <!--<div matListItemLine class="opacity-70">ID: {{ l.municipalityId }}</div>-->
<div><button matFab extended  (click)="searchPlans(l)"><mat-icon>search</mat-icon> Buscar planes</button></div>

        </div>

        <div class="event-card__trail">     
           

          <button matMiniFab class="btn-danger" (click)="remove(l.municipalityId)" [matTooltip]="'Eliminar lugar'" aria-label="Eliminar lugar">
            <mat-icon>delete</mat-icon>
          </button>
         </div>
        
      </mat-card>
    </div>
  </ng-container>
</div>
</section>
