<div class="home-wrapper">

  <!-- Hero -->
  <div class="hero">

    <div class="hero__title"><h1>Planes para disfrutar en familia en Euskadi</h1></div>
    <div class="hero__img">
      <picture>
        <source
          type="image/webp"
          srcset="
            assets/images/portada-400.webp 400w,
            assets/images/portada-600.webp 600w
          "
          sizes="(max-width: 400px) 400px, 600px"
        />
        <img
          src="assets/images/portada-600.webp"
          width="600"
          height="354"
          fetchpriority="high"
          decoding="async"
          alt=""
        />
      </picture>

    </div>
  </div>

  <!-- Cuándo quieres tu plan -->
  <section class="section">
    <div class="section__header">
      <h2>¿Cuándo quieres tu plan?</h2>
    </div>

    <div class="quick-grid">
      <button matButton="elevated" class="quick" (click)="goToday()">
        <mat-icon>calendar_today</mat-icon>
        <span>Hoy</span>
      </button>

      <button matButton="elevated" class="quick" (click)="goTomorrow()">
        <mat-icon>event</mat-icon>
        <span>Mañana</span>
      </button>

      <button matButton="elevated" class="quick" (click)="goNextWeekend()">
        <mat-icon>weekend</mat-icon>
        <span>Fin de semana</span>
      </button>

      <button matButton="elevated" class="quick" (click)="openDateDialog()">
        <mat-icon>date_range</mat-icon>
        <span>Otra fecha</span>
      </button>
    </div>
  </section>

  <!-- Tipos de planes -->
  <section class="section">
    <div class="section__header">
      <h2>Tipos de planes</h2>
    </div>

    <div class="types-row">
      <button
        mat-stroked-button
        class="type-chip"
        *ngFor="let t of planTypes"
        (click)="goType(t.id)">
        <mat-icon>{{ t.icon }}</mat-icon>
        <span>{{ t.label }}</span>
      </button>
    </div>
  </section>

  <!-- Últimos planes añadidos -->
  <section class="section">
    <div class="section__header">
      <h2>¿Y si hace mal tiempo? Planes en interior</h2>
      <button mat-icon-button aria-label="Ver más" 
       [routerLink]="['/planes']"
       [queryParams]="{ is_indoor: true }">
        <mat-icon>arrow_forward</mat-icon>
      </button>
    </div>

    <div class="carousel-wrap">
      <button mat-mini-fab class="nav prev" (click)="scroll('prev')" aria-label="Anterior">
        <mat-icon>chevron_left</mat-icon>
      </button>

      <div #carousel class="carousel" tabindex="0">
        <ng-container *ngIf="(latestIndoor$ | async) as latest; else noIndoor">
        <mat-card class="plan-card" *ngFor="let p of latest">
          <!--<div class="img" [class.placeholder]="!p.image" [style.backgroundImage]="p.image ? 'url(' + p.image + ')' : ''"></div>-->
                <!-- Imagen -->
        <div class="img" [class.placeholder]="!p.image">
          <img
            *ngIf="p.image; else imgPlaceholder"
            class="img__el"
            [src]="p.image"
            alt=""
            loading="lazy"
            decoding="async"
            width="280"
            height="160"
            referrerpolicy="no-referrer"
          />
          <ng-template #imgPlaceholder></ng-template>
        </div>  
          <div class="meta">
            <div class="title">{{ p.title }}</div>
            <div class="sub">{{ p.city }} ({{ p.date | date:'dd/MM/yyyy' }})</div>
          </div>
          <div class="actions">
            <a mat-button [routerLink]="['/event', p.id]">
              Ver detalle
            </a>
          </div>
        </mat-card>
        </ng-container>
        <ng-template #noIndoor>
          <div class="no-items">
            No hay eventos en interiores.
          </div>
        </ng-template>
      
      </div>

      <button mat-mini-fab class="nav next" (click)="scroll('next')" aria-label="Siguiente">
        <mat-icon>chevron_right</mat-icon>
      </button>
    </div>
  </section>

</div>
